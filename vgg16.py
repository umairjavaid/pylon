
"""
Original code: https://github.com/pytorch/vision/blob/master/torchvision/models/vgg.py
"""

import os
import torch
import torch.nn as nn
import torch.nn.functional as F
from torch.utils.model_zoo import load_url

from .method import AcolBase
from .method import ADL
from .method import spg
from .method import mymodel
from .method import mymodel2
from .method import mymodel45
from .method import MyModel2
from .method.util import normalize_tensor
from .util import remove_layer
from .util import replace_layer
from .util import initialize_weights

import matplotlib.pyplot as plt

from torchvision import datasets, models, transforms

import copy

__all__ = ['vgg16']

model_urls = {
    'vgg16': 'https://download.pytorch.org/models/vgg16-397923af.pth'
}

configs_dict = {
    'cam': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 512, 512,
                  512, 'M', 512, 512, 512],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 512, 512,
                  512, 512, 512, 512],
    },
    'acol': {
        '14x14': [64, 64, 'M1', 128, 128, 'M1', 256, 256, 256, 'M1', 512, 512,
                  512, 'M1', 512, 512, 512, 'M2'],
        '28x28': [64, 64, 'M1', 128, 128, 'M1', 256, 256, 256, 'M1', 512, 512,
                  512, 'M2', 512, 512, 512, 'M2'],
    },
    'spg': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M'],
    },
    'adl': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'A', 512,
                  512, 512, 'A', 'M', 512, 512, 512, 'A'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'A', 512,
                  512, 512, 'A', 512, 512, 512, 'A'],
    },
    'mymodel': {
        '14x14': [64, 64, 'M1', 128, 128, 'M1', 256, 256, 256, 'M1', 512, 512,
                  512, 'M1', 512, 512, 512, 'M2'],
        '28x28': [64, 64, 'M1', 128, 128, 'M1', 256, 256, 256, 'M1', 512, 512,
                  512, 'M2', 512, 512, 512, 'M2'],
    },
    'mymodel2': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel5': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel6': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel7': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel8': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel15': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel16': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel17': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'A', 512,
                  512, 512, 'A', 'M', 512, 512, 512, 'A'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'A', 512,
                  512, 512, 'A', 512, 512, 512, 'A'],
    },
    'mymodel18': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 512, 512,
                  512, 'M', 512, 512, 512],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 512, 512,
                  512, 512, 512, 512],
    },
    'mymodel19': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel20': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel21': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel22': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel23': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel24': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel25': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel26': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel27': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel28': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel29': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel30': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel31': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel32': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel34': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel35': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel36': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I'],
    },
    'mymodel37': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I'],
    },
    'mymodel38': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I'],
    },
    'mymodel39': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel40': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel41': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel42': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel43': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel44': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel45': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel46': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel47': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel48': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel49': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    },
    'mymodel50': {
        '14x14': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 'M', 512, 512, 512, 'I'],
        '28x28': [64, 64, 'M', 128, 128, 'M', 256, 256, 256, 'M', 'I', 512,
                  512, 512, 'I', 512, 512, 512, 'I'],
    }
}
